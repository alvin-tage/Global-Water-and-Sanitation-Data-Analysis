---
title: "Infographic Description"
author: "Ferdinand David Anggono (2702299661) - Yosia (2702300240) - Rainer Alexander
  Irawan (2702261196) - Alvin Febrian (2702370814)"
date: "2025-06-04"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(tidyverse)
library(readxl)
library(readr)
library(ggrepel)
library(ggalt)
library(countrycode)
library(rnaturalearth)
library(sf)
library(RColorBrewer)
library(plotly)
library(viridis)
library(psych)
```

#Introduction

This report presents an analysis of data related to drinking water quality and sanitation. The data used is taken from two CSV files:
- **drinking_water_dataset.csv**
- **sanitation_dataset.csv**

# 2. Objectives

The objectives of this analysis are:
- Understand the distribution of drinking water and sanitation quality
- Identify important variables
- Conduct reliability tests and interpret results

# 3. Data

## 3.1 Reading Data
```{r}
drinking_data <- read.csv("drinking_water_dataset.csv")
sanitation_data <- read.csv("sanitation_dataset.csv")

# Tampilkan ringkasan data
summary(drinking_data)
summary(sanitation_data)
```
**Explanation:**
This section reads the available datasets. The dataset `drinking_water_dataset.csv` contains drinking water quality data, while `sanitation_dataset.csv` contains sanitation data. The `summary()` function is used to display the initial statistical summary.

# 4. Data Analysis

## 4.1 Question 1: Available Variables

**Question:**
What are the available variables in both datasets?
```{r}
names(drinking_data)
names(sanitation_data)
```
**Explanation:**
This section displays the names of the columns or variables available in the drinking water and sanitation dataset. This is important as a basis for further analysis.

## 4.2 Question 2: Data Distribution

**Question:**
How is the data distributed on each of the important variables?
```{r}
hist(drinking_data$Coverage, main = "Global Drinking Water Coverage Distribution", xlab = "Drinking Water Coverage (%)")
hist(sanitation_data$Coverage, main = "Global Sanitation coverage Distribution", xlab = "Sanitation Coverage (%)")
```
**Explanation:**
The histogram visualization is used to see the distribution of values in the variables `Coverage`. The distribution helps us understand whether the data is skewed to the left, right, or normal. Both distribution are right-skewed, indicating a large number of regions still have very low access to sanitation and drinking water facility. Meanwhile, only a few region achieved close to 100% coverage.

# 5. Data Visualization

## 5.1 Plot 1

**Question:**
What has been the trend in access to safely managed drinking water services in the world over the past fifteen years?

```{r}
# Merge country based on continent
drinking_data <- drinking_data %>%
  mutate(Continent = countrycode(ISO3, origin = "iso3c", destination = "continent"))

# Filter only safe drinking water service
drinking_data_filtered <- drinking_data %>%
  filter(`Service.level` == "Safely managed service")

# Remove N/A value after
drinking_data_filtered <- drinking_data_filtered %>%
  filter(!is.na(Continent))

# Trend per continent
trend_by_continent <- drinking_data_filtered %>%
  group_by(Continent, Year) %>%
  summarise(Average_Coverage = mean(Coverage, na.rm = TRUE), .groups = "drop")

# Global Trend (average per country)
trend_global <- drinking_data_filtered  %>%
  group_by(Year) %>%
  summarise(Average_Coverage = mean(Coverage, na.rm = TRUE), .groups = "drop") %>%
  mutate(Continent = "Global Average")  # pakai label baru

# Merge those two trends
trend_combined <- bind_rows(trend_by_continent, trend_global)

# Plot
p <- ggplot(trend_combined, aes(
  x = Year,
  y = Average_Coverage,
  color = Continent,
  group = Continent,
  text = paste("Tahun:", Year,
               "<br>Wilayah:", Continent,
               "<br>Cakupan:", round(Average_Coverage, 1), "%"))
) +
  geom_line(size = 1.2, alpha = 0.7) +
  geom_point() +
  labs(
    title = "Clean Drinking Water Access Trends by Continent and Global Average",
    x = "Years",
    y = "Average Coverage (%)",
    color = "Regions/Country"
  ) +
  scale_color_manual(
    values = c(
      "Africa" = "#449cd3",
      "Asia" = "#d8b655",
      "Europe" = "#7a61ba",
      "Americas" = "#46d39a",
      "Oceania" = "#e55759",
      "Global" = "#121212"
    )
  ) +
  theme_minimal()

ggplotly(p, tooltip = "text")

# Shows the average clean water coverage for each country (Table)
table_output <- trend_combined %>%
  pivot_wider(names_from = Continent, values_from = Average_Coverage) %>%
  arrange(Year)

print(table_output)
```
## 5.2 Plot 2

**Question:**
What is the global geographic distribution of access to safely managed drinking water services in 2022?
```{r}
# Filter for Years:"2022" and Service level: "Safely managed service"
drinking_data_2022 <- drinking_data %>%
  filter(`Service.level` == "Safely managed service", Year == 2022) %>%
  filter(!is.na(Coverage)) %>%
  select(Country, ISO3, Coverage)

# Interactive map using plotly::plot_geo
fig <- plot_geo(drinking_data_2022)

fig <- fig %>%
  add_trace(
    z = ~Coverage,
    color = ~Coverage,
    colors = "viridis",
    text = ~paste("Negara:", Country,
                  "<br>Cakupan:", round(Coverage, 1), "%"),
    locations = ~ISO3,
    locationmode = "ISO-3",
    type = "choropleth"
  ) %>%
  colorbar(title = "Coverage (%)") %>%
  layout(
    title = "Coverage of Access to Safe Drinking Water by Country (2022)",
    geo = list(
      showframe = FALSE,
      showcoastlines = TRUE,
      coastlinecolor = "gray",
      projection = list(type = "natural earth")
    )
  )

fig

# Table form of the plot
print(drinking_data_2022)
```
## 5.3 Plot 3

**Question:**
Which countries have the highest and lowest clean water coverage? (Shows 10 countries each)
```{r}
# Find the top 10 highest
top10 <- drinking_data_2022 %>%
  arrange(desc(Coverage)) %>%
  slice_head(n = 10)

# Find the top 10 lowest
bottom10 <- drinking_data_2022 %>%
  arrange(Coverage) %>%
  slice_head(n = 10)

# Merge and give them label
top10 <- top10 %>% mutate(Group = "Highest")
bottom10 <- bottom10 %>% mutate(Group = "Lowest")

plot_data <- bind_rows(top10, bottom10) %>%
  # Urutkan untuk tampilan barplot (descending untuk tertinggi, ascending untuk terendah)
  mutate(Country = factor(Country, levels = unique(Country)))

# Plotting
fig <- plot_ly(plot_data, 
               x = ~Coverage, 
               y = ~Country, 
               color = ~Group,
               colors = c("Lowest" = "red", "Highest" = "blue"),
               type = "bar",
               text = ~paste0(Country, ": ", round(Coverage, 1), "%"),  # Teks yang akan ditampilkan
               textposition = "outside",
               textfont = list(color = "black"),
               orientation = "h",
               hovertemplate = "Country: %{y}<br>Coverage: %{x:.1f}%")  %>%
  layout(title = "10 Countries with the Highest and Lowest Coverage of Safe Drinking Water Access (2022)",
         xaxis = list(title = "Coverage (%)", range = c(0, 150) ),
         yaxis = list(title = "Country", autorange = "reversed"),
         barmode = "group",
         margin = list(l = 200, r = 50, t = 80, b = 120))

fig
```
## 5.4 Plot 4

**Question:**
Which country experienced the highest increase in access to clean water during the period 2007–2022?
```{r}
# Filter data service level: safely managed
drinking_increase <- drinking_data %>%
  filter(`Service.level` == "Safely managed service", Year %in% c(2007, 2022)) %>%
  select(Country, ISO3, Year, Coverage)

# Separate 2007 and 2022 data to calculate their difference
water_start <- drinking_increase %>%
  filter(Year == 2007) %>%
  select(Country, ISO3, Start = Coverage)

water_end <- drinking_increase %>%
  filter(Year == 2022) %>%
  select(Country, ISO3, End = Coverage)

water_change <- left_join(water_start, water_end, by = c("Country", "ISO3")) %>%
  mutate(Change = End - Start) %>%
  filter(!is.na(Change))

# Find top 15 country
top_increase <- water_change %>%
  arrange(desc(Change)) %>%
  slice_head(n = 15) %>%
  mutate(Country = factor(Country, levels = rev(Country)))

# Plotting
fig <- plot_ly(top_increase,
               x = ~Change,
               y = ~Country,
               type = 'bar',
               orientation = 'h',
               marker = list(color = 'viridis'),
               text = ~paste("Country:", Country,
                             "<br>Increase:", round(Change, 1), "%"),
               hoverinfo = "text") %>%
  layout(title = "Top 15 Improvements in Clean Water Access by Country (2007–2022))",
         xaxis = list(title = "Increased Coverage (%)"),
         yaxis = list(title = "Country", autorange = "reversed"))

fig
```
## 5.4 Plot 5

**Question:**
Is there a positive correlation between increased access to clean drinking water and better sanitation practices?
```{r}
#Filter data service level: safely managed service
clean_water <- drinking_data %>%
   filter(`Service.level` == "Safely managed service") %>%
  group_by(Year) %>%
  summarise(Global_Water = mean(Coverage, na.rm = TRUE), .groups = "drop")

clean_sanitation <- sanitation_data %>%
  filter(`Service.level` == "Safely managed service") %>%
  group_by(Year) %>%
  summarise(Global_Sanitation = mean(Coverage, na.rm = TRUE), .groups = "drop")

#Merge them by years
global_trend <- inner_join(clean_water, clean_sanitation, by = "Year")

#Plotting
plot_ly(global_trend,
        x = ~Global_Sanitation,
        y = ~Global_Water,
        type = 'scatter',
        mode = 'markers+lines',
        text = ~paste("Tahun:", Year,
                      "<br>Sanitasi Aman:", round(Global_Sanitation, 1), "%",
                      "<br>Air Minum Aman:", round(Global_Water, 1), "%"),
        hoverinfo = "text",
        textposition = "top center",
        marker = list(size = 8, color = ~Year, colorscale = 'Blues', showscale = TRUE),
        line = list(color = 'gray', dash = 'dot')) %>%
  layout(
    title = "The Relationship between Sanitation and Safe Drinking Water",
    xaxis = list(title = "Global Coverage of Safe Sanitation(%)"),
    yaxis = list(title = "Global Coverage of Safe Drinking Water(%)"),
    hovermode = "closest"
  )

```
**Correlation Test**
```{r}
cor_value <- cor(global_trend$Global_Sanitation, global_trend$Global_Water, use = "complete.obs", method = "pearson")
print(cor_value)

cor.test(global_trend$Global_Sanitation, global_trend$Global_Water)

```
#Interpretation of Correlation Values and Significance Tests
- Pearson Correlation Value (r) = 0.986, indicating a very strong positive relationship between safe sanitation coverage and access to safe drinking water
- p-value = 2.252e-12, a value less than 0.05, indicating a very significant relationship
Based on the analysis of WASH Household data from 2007 to 2022, a very strong correlation was found between safe sanitation coverage and access to safe drinking water globally, with a Pearson correlation value of r = 0.986 (p <0.001). This shows that countries that improve sanitation infrastructure also tend to experience significant increases in access to safe drinking water.
```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
