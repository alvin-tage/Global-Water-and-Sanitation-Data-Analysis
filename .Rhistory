knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(readr)
library(ggrepel)
library(ggalt)
library(countrycode)
library(rnaturalearth)
library(sf)
library(RColorBrewer)
library(plotly)
library(viridis)
library(psych)
drinking_data <- read.csv("drinking_water_dataset.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(readr)
library(ggrepel)
library(ggalt)
library(countrycode)
library(rnaturalearth)
library(sf)
library(RColorBrewer)
library(plotly)
library(viridis)
library(psych)
drinking_data <- read.csv("datasets/drinking_water_dataset.csv")
sanitation_data <- read.csv("datasets/sanitation_dataset.csv")
# Tampilkan ringkasan data
summary(drinking_data)
summary(sanitation_data)
names(drinking_data)
names(sanitation_data)
hist(drinking_data$Coverage, main = "Global Drinking Water Coverage Distribution", xlab = "Drinking Water Coverage (%)")
hist(sanitation_data$Coverage, main = "Global Sanitation coverage Distribution", xlab = "Sanitation Coverage (%)")
# Merge country based on continent
drinking_data <- drinking_data %>%
mutate(Continent = countrycode(ISO3, origin = "iso3c", destination = "continent"))
# Filter only safe drinking water service
drinking_data_filtered <- drinking_data %>%
filter(`Service.level` == "Safely managed service")
# Remove N/A value after
drinking_data_filtered <- drinking_data_filtered %>%
filter(!is.na(Continent))
# Trend per continent
trend_by_continent <- drinking_data_filtered %>%
group_by(Continent, Year) %>%
summarise(Average_Coverage = mean(Coverage, na.rm = TRUE), .groups = "drop")
# Global Trend (average per country)
trend_global <- drinking_data_filtered  %>%
group_by(Year) %>%
summarise(Average_Coverage = mean(Coverage, na.rm = TRUE), .groups = "drop") %>%
mutate(Continent = "Global Average")  # pakai label baru
# Merge those two trends
trend_combined <- bind_rows(trend_by_continent, trend_global)
# Plot
p <- ggplot(trend_combined, aes(
x = Year,
y = Average_Coverage,
color = Continent,
group = Continent,
text = paste("Tahun:", Year,
"<br>Wilayah:", Continent,
"<br>Cakupan:", round(Average_Coverage, 1), "%"))
) +
geom_line(size = 1.2, alpha = 0.7) +
geom_point() +
labs(
title = "Clean Drinking Water Access Trends by Continent and Global Average",
x = "Years",
y = "Average Coverage (%)",
color = "Regions/Country"
) +
scale_color_manual(
values = c(
"Africa" = "#449cd3",
"Asia" = "#d8b655",
"Europe" = "#7a61ba",
"Americas" = "#46d39a",
"Oceania" = "#e55759",
"Global" = "#121212"
)
) +
theme_minimal()
ggplotly(p, tooltip = "text")
# Shows the average clean water coverage for each country (Table)
table_output <- trend_combined %>%
pivot_wider(names_from = Continent, values_from = Average_Coverage) %>%
arrange(Year)
print(table_output)
# Filter for Years:"2022" and Service level: "Safely managed service"
drinking_data_2022 <- drinking_data %>%
filter(`Service.level` == "Safely managed service", Year == 2022) %>%
filter(!is.na(Coverage)) %>%
select(Country, ISO3, Coverage)
# Interactive map using plotly::plot_geo
fig <- plot_geo(drinking_data_2022)
fig <- fig %>%
add_trace(
z = ~Coverage,
color = ~Coverage,
colors = "viridis",
text = ~paste("Negara:", Country,
"<br>Cakupan:", round(Coverage, 1), "%"),
locations = ~ISO3,
locationmode = "ISO-3",
type = "choropleth"
) %>%
colorbar(title = "Coverage (%)") %>%
layout(
title = "Coverage of Access to Safe Drinking Water by Country (2022)",
geo = list(
showframe = FALSE,
showcoastlines = TRUE,
coastlinecolor = "gray",
projection = list(type = "natural earth")
)
)
fig
# Table form of the plot
print(drinking_data_2022)
# Find the top 10 highest
top10 <- drinking_data_2022 %>%
arrange(desc(Coverage)) %>%
slice_head(n = 10)
# Find the top 10 lowest
bottom10 <- drinking_data_2022 %>%
arrange(Coverage) %>%
slice_head(n = 10)
# Merge and give them label
top10 <- top10 %>% mutate(Group = "Highest")
bottom10 <- bottom10 %>% mutate(Group = "Lowest")
plot_data <- bind_rows(top10, bottom10) %>%
# Urutkan untuk tampilan barplot (descending untuk tertinggi, ascending untuk terendah)
mutate(Country = factor(Country, levels = unique(Country)))
# Plotting
fig <- plot_ly(plot_data,
x = ~Coverage,
y = ~Country,
color = ~Group,
colors = c("Lowest" = "red", "Highest" = "blue"),
type = "bar",
text = ~paste0(Country, ": ", round(Coverage, 1), "%"),  # Teks yang akan ditampilkan
textposition = "outside",
textfont = list(color = "black"),
orientation = "h",
hovertemplate = "Country: %{y}<br>Coverage: %{x:.1f}%")  %>%
layout(title = "10 Countries with the Highest and Lowest Coverage of Safe Drinking Water Access (2022)",
xaxis = list(title = "Coverage (%)", range = c(0, 150) ),
yaxis = list(title = "Country", autorange = "reversed"),
barmode = "group",
margin = list(l = 200, r = 50, t = 80, b = 120))
fig
# Filter data service level: safely managed
drinking_increase <- drinking_data %>%
filter(`Service.level` == "Safely managed service", Year %in% c(2007, 2022)) %>%
select(Country, ISO3, Year, Coverage)
# Separate 2007 and 2022 data to calculate their difference
water_start <- drinking_increase %>%
filter(Year == 2007) %>%
select(Country, ISO3, Start = Coverage)
water_end <- drinking_increase %>%
filter(Year == 2022) %>%
select(Country, ISO3, End = Coverage)
water_change <- left_join(water_start, water_end, by = c("Country", "ISO3")) %>%
mutate(Change = End - Start) %>%
filter(!is.na(Change))
# Find top 15 country
top_increase <- water_change %>%
arrange(desc(Change)) %>%
slice_head(n = 15) %>%
mutate(Country = factor(Country, levels = rev(Country)))
# Plotting
fig <- plot_ly(top_increase,
x = ~Change,
y = ~Country,
type = 'bar',
orientation = 'h',
marker = list(color = 'viridis'),
text = ~paste("Country:", Country,
"<br>Increase:", round(Change, 1), "%"),
hoverinfo = "text") %>%
layout(title = "Top 15 Improvements in Clean Water Access by Country (2007â€“2022))",
xaxis = list(title = "Increased Coverage (%)"),
yaxis = list(title = "Country", autorange = "reversed"))
fig
#Filter data service level: safely managed service
clean_water <- drinking_data %>%
filter(`Service.level` == "Safely managed service") %>%
group_by(Year) %>%
summarise(Global_Water = mean(Coverage, na.rm = TRUE), .groups = "drop")
clean_sanitation <- sanitation_data %>%
filter(`Service.level` == "Safely managed service") %>%
group_by(Year) %>%
summarise(Global_Sanitation = mean(Coverage, na.rm = TRUE), .groups = "drop")
#Merge them by years
global_trend <- inner_join(clean_water, clean_sanitation, by = "Year")
#Plotting
plot_ly(global_trend,
x = ~Global_Sanitation,
y = ~Global_Water,
type = 'scatter',
mode = 'markers+lines',
text = ~paste("Tahun:", Year,
"<br>Sanitasi Aman:", round(Global_Sanitation, 1), "%",
"<br>Air Minum Aman:", round(Global_Water, 1), "%"),
hoverinfo = "text",
textposition = "top center",
marker = list(size = 8, color = ~Year, colorscale = 'Blues', showscale = TRUE),
line = list(color = 'gray', dash = 'dot')) %>%
layout(
title = "The Relationship between Sanitation and Safe Drinking Water",
xaxis = list(title = "Global Coverage of Safe Sanitation(%)"),
yaxis = list(title = "Global Coverage of Safe Drinking Water(%)"),
hovermode = "closest"
)
cor_value <- cor(global_trend$Global_Sanitation, global_trend$Global_Water, use = "complete.obs", method = "pearson")
print(cor_value)
cor.test(global_trend$Global_Sanitation, global_trend$Global_Water)
plot(pressure)
